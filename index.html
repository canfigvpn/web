<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SS Proxy List</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: white;
  margin: 0;
  padding: 20px;
}

h1 {
  text-align: center;
}

button {
  padding: 10px 15px;
  background: #22c55e;
  border: none;
  color: white;
  border-radius: 8px;
  cursor: pointer;
}

button:hover {
  opacity: 0.9;
}

.proxy-box {
  background: #1e293b;
  padding: 10px;
  margin: 10px 0;
  border-radius: 10px;
  word-break: break-all;
}

.copy-btn {
  margin-top: 8px;
  background: #3b82f6;
}
</style>
</head>
<body>

<h1>Shadowsocks (SS) Links</h1>
<button onclick="loadProxies()">Load Proxies</button>

<div id="proxyList"></div>

<script>
async function loadProxies() {
  const container = document.getElementById("proxyList");
  container.innerHTML = "Loading...";

  try {
    const response = await fetch("https://shadowmere.xyz/api/proxies/?format=json");
    const data = await response.json();

    renderSS(data);

  } catch (error) {
    container.innerHTML = "Error loading data (Possible CORS issue)";
    console.error(error);
  }
}

function renderSS(data) {
  const container = document.getElementById("proxyList");
  container.innerHTML = "";

  let proxies = [];

  // حالت A
  if (Array.isArray(data)) {
    proxies = data;
  }

  // حالت B
  else if (data.proxies) {
    proxies = data.proxies;
  }

  const ssLinks = proxies
    .map(p => p.url || p)
    .filter(link => typeof link === "string" && link.startsWith("ss://"));

  if (ssLinks.length === 0) {
    container.innerHTML = "No SS links found.";
    return;
  }

  ssLinks.forEach(link => {
    const div = document.createElement("div");
    div.className = "proxy-box";

    div.innerHTML = `
      <div>${link}</div>
      <button class="copy-btn" onclick="copyText('${link}')">Copy</button>
    `;

    container.appendChild(div);
  });
}

function copyText(text) {
  navigator.clipboard.writeText(text);
  alert("Copied!");
}
</script>

</body>
</html>